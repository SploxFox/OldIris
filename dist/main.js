!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(1).Iris)(window.location.hash.substr(1));function s(){window.scrollTo(0,1)}document.body.appendChild(r.element),window.addEventListener("touchmove",s),s()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),s=n(3),i=n(4);t.Iris=class{constructor(e){this.touchStarted=!1,this.userInterface=new i.UserInterface,this.visuals=new s.Visuals,this.storyManager=new r.StoryManager(e),this.storyManager.currentCue.speech||this.storyManager.goToNextSpeech(),this.element=document.createElement("div"),this.element.classList.add("game");var t=document.createElement("div");t.classList.add("interface-wrapper"),t.appendChild(this.userInterface.textBox.element),this.element.appendChild(t),this.userInterface.textBox.showText(this.storyManager.currentCue.character,this.storyManager.currentSpeech),window.addEventListener("touchstart",function(){this.advance(),this.touchStarted=!0}.bind(this)),window.addEventListener("click",function(){this.touchStarted?this.touchStarted=!1:this.advance()}.bind(this))}advance(){this.storyManager.goToNextSpeech(),this.userInterface.textBox.showText(this.storyManager.currentCue.character,this.storyManager.currentSpeech)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StoryManager=class{constructor(e){this.currentEpisodePosition=0,this.currentChapterPosition=0,this.currentCuePosition=0,this.currentSpeechPosition=0,this._currentEvidence=[];var t=new XMLHttpRequest;t.open("GET",e,!1),t.send(null),console.log(t.responseText),this.story=JSON.parse(t.responseText),console.log(this.story)}get currentSpeech(){var e=this.story.episodes[this.currentEpisodePosition].chapters[this.currentChapterPosition].content[this.currentCuePosition].speech[this.currentSpeechPosition];return console.log(e),e}get currentCue(){var e=this.story.episodes[this.currentEpisodePosition].chapters[this.currentChapterPosition].content[this.currentCuePosition];if(null==e)throw"Error: Found cue to be undefined!";return e}get currentChapter(){return this.story.episodes[this.currentEpisodePosition].chapters[this.currentChapterPosition]}get currentEpisode(){return this.story.episodes[this.currentEpisodePosition]}get currentEvidence(){return this._currentEvidence}register(){this.currentCue.newevidence&&this._currentEvidence.push({name:this.currentCue.name,id:this.currentCue.newevidence,image:this.currentCue.image?this.currentCue.image:"https://previews.123rf.com/images/iqoncept/iqoncept0901/iqoncept090100094/4221417-a-white-wrinkled-piece-of-paper-background-for-slides-brochures-and-presentations-.jpg"})}advance(){this.currentCue.speech&&this.currentCue.speech.length-1>this.currentSpeechPosition?(this.currentSpeechPosition++,console.log("Advanced to next speech. New position: "+this.currentSpeechPosition)):this.currentChapter.content.length>this.currentCuePosition?(this.currentCuePosition++,this.currentSpeechPosition=0,console.log("Advanced to next cue.")):this.currentEpisode.chapters.length>this.currentChapterPosition&&(this.currentChapterPosition++,this.currentSpeechPosition=0,this.currentCuePosition=0,console.log("Advanced to next chapter."))}goToNextSpeech(){do{this.register(),this.advance()}while(!this.currentCue.speech)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Visuals=class{constructor(){this.canvas=document.createElement("canvas"),this.canvas.classList.add("visuals"),this.context=this.canvas.getContext("2d"),this.context.rect(10,10,20,20)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),s=n(6);t.UserInterface=class{constructor(){this.textBox=new r.TextBox,this.courtRecord=new s.CourtRecord}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.element=document.createElement("div"),this.element.classList.add("text","text-box"),this.speakerElement=document.createElement("span"),this.speakerElement.classList.add("name"),this.textElement=document.createElement("div"),this.textElement.classList.add("text-block"),this.element.appendChild(this.speakerElement),this.element.appendChild(this.textElement)}clear(){for(;this.textElement.firstElementChild;)this.textElement.firstElementChild.remove();this.speakerElement.textContent="",this.blipNum=0,this.isFinished=!1}showText(e,t){this.clear(),this.speakerElement.textContent=e;var n="fast",s="speech",i=function(e){if("#"!=t[e]||"#"!=t[e+1])return{character:t[e],mode:s,speed:n,index:e};try{for(var r="",i=e+2;"("!=t[i]&&t.length>i;i++)r+=t[i];for(var o,c="",a=i+1;")"!=t[a]&&t.length>a;a++)c+=t[a];switch(o=c.split(","),r){case"mode":s=o[0];break;case"speed":n=o[0]}return{index:a}}catch(e){console.log("Unable to parse command!"),console.log(e)}}.bind(this);for(var o=0;o<t.length;o++){var c=i(o);if(r.instanceOfQueuedCharacter(c)){var a=document.createElement("span");a.classList.add("text",s,"hidden"),a.textContent=t[o],a.dataset.index=""+o,this.textElement.appendChild(a)}else o=c.index}(function e(s){window.setTimeout(function(){if(s<t.length){var n=i(s),o=n.index+1;r.instanceOfQueuedCharacter(n)&&this.addChar(n),e.bind(this)(o)}}.bind(this),r.getWaitTime(n))}).bind(this)(0)}static getWaitTime(e){switch(e){case"fast":return 20;case"slow":return 50;case"very-slow":return 200}}static instanceOfQueuedCharacter(e){return void 0!==e.character}addChar(e){document.querySelector("[data-index='"+e.index+"']").classList.remove("hidden");this.blipNum++," "==e.character&&(this.blipNum=0)}}t.TextBox=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CourtRecord=class{constructor(){this.element=document.createElement("div"),this.element.classList.add("court-record","text")}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9pcmlzLnRzIiwid2VicGFjazovLy8uL3NyYy9zdG9yeS9zdG9yeS1tYW5hZ2VyLnRzIiwid2VicGFjazovLy8uL3NyYy92aXN1YWxzLnRzIiwid2VicGFjazovLy8uL3NyYy91c2VyLWludGVyZmFjZS9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXNlci1pbnRlcmZhY2UvdGV4dC1ib3gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3VzZXItaW50ZXJmYWNlL2NvdXJ0LXJlY29yZC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImdhbWUiLCJJcmlzIiwid2luZG93IiwibG9jYXRpb24iLCJoYXNoIiwic3Vic3RyIiwiaGlkZUJvdHRvbUJhciIsInNjcm9sbFRvIiwiZG9jdW1lbnQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJlbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0b3J5X21hbmFnZXJfMSIsInZpc3VhbHNfMSIsInVzZXJfaW50ZXJmYWNlXzEiLCJbb2JqZWN0IE9iamVjdF0iLCJwYXRoIiwidGhpcyIsInRvdWNoU3RhcnRlZCIsInVzZXJJbnRlcmZhY2UiLCJVc2VySW50ZXJmYWNlIiwidmlzdWFscyIsIlZpc3VhbHMiLCJzdG9yeU1hbmFnZXIiLCJTdG9yeU1hbmFnZXIiLCJjdXJyZW50Q3VlIiwic3BlZWNoIiwiZ29Ub05leHRTcGVlY2giLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiZ3VpV3JhcHBlciIsInRleHRCb3giLCJzaG93VGV4dCIsImNoYXJhY3RlciIsImN1cnJlbnRTcGVlY2giLCJhZHZhbmNlIiwiY3VycmVudEVwaXNvZGVQb3NpdGlvbiIsImN1cnJlbnRDaGFwdGVyUG9zaXRpb24iLCJjdXJyZW50Q3VlUG9zaXRpb24iLCJjdXJyZW50U3BlZWNoUG9zaXRpb24iLCJfY3VycmVudEV2aWRlbmNlIiwicmVxdWVzdCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNlbmQiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2VUZXh0Iiwic3RvcnkiLCJKU09OIiwicGFyc2UiLCJlcGlzb2RlcyIsImNoYXB0ZXJzIiwiY29udGVudCIsImN1ZSIsInVuZGVmaW5lZCIsImN1cnJlbnRDaGFwdGVyIiwiY3VycmVudEVwaXNvZGUiLCJjdXJyZW50RXZpZGVuY2UiLCJuZXdldmlkZW5jZSIsInB1c2giLCJpZCIsImltYWdlIiwibGVuZ3RoIiwicmVnaXN0ZXIiLCJjYW52YXMiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsInJlY3QiLCJ0ZXh0X2JveF8xIiwiY291cnRfcmVjb3JkXzEiLCJUZXh0Qm94IiwiY291cnRSZWNvcmQiLCJDb3VydFJlY29yZCIsInNwZWFrZXJFbGVtZW50IiwidGV4dEVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsInJlbW92ZSIsInRleHRDb250ZW50IiwiYmxpcE51bSIsImlzRmluaXNoZWQiLCJzcGVha2VyIiwidGV4dCIsImNsZWFyIiwic3BlZWQiLCJwYXJzZUNoYXIiLCJpbmRleCIsImNvbW1hbmQiLCJwYXJhbXMiLCJwYXJhbVN0cmluZyIsImoiLCJzcGxpdCIsImUiLCJjaGFyIiwiaW5zdGFuY2VPZlF1ZXVlZENoYXJhY3RlciIsImNoYXJFbGVtZW50IiwiZGF0YXNldCIsIm5leHRDaGFyIiwic2V0VGltZW91dCIsIm5leHRJbmRleCIsImFkZENoYXIiLCJnZXRXYWl0VGltZSIsInF1ZXJ5U2VsZWN0b3IiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQTFCLEVBQUFrQixFQUFBTyxHQUNBWCxPQUFBQyxlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQXJCLEVB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QUNYLElBQUssT0FDRCxPQUFPLEdBQ1gsSUFBSyxZQUNELE9BQU8sS0FJbkJ0RSxpQ0FBaUMrRSxHQUc3QixZQUEwQnRDLElBQW5Cc0MsRUFBSzVELFVBR2hCbkIsUUFBUStFLEdBQ2N2RixTQUFTZ0csY0FBYyxnQkFBa0JULEVBQUtQLE1BQVEsTUFFNUQxRCxVQUFVaUQsT0FBTyxVQWU3QjdELEtBQUsrRCxVQUNpQixLQUFsQmMsRUFBSzVELFlBQ0xqQixLQUFLK0QsUUFBVSxJQXJKM0JuSCxFQUFBMkcseUZDUEEzRyxFQUFBNkcsWUFBQSxNQUdJM0QsY0FDSUUsS0FBS1AsUUFBVUgsU0FBU3FCLGNBQWMsT0FDdENYLEtBQUtQLFFBQVFtQixVQUFVQyxJQUFJLGVBQWUiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IElyaXMgfSBmcm9tIFwiLi9pcmlzXCI7XHJcblxyXG52YXIgZ2FtZSA9IG5ldyBJcmlzKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cigxKSk7XHJcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZ2FtZS5lbGVtZW50KTtcclxuXHJcblxyXG4vL05vdyBsZXQncyB0YWNrbGUgdGhhdCBzdHVwaWQgYm90dG9tIGJhciBvbiBpT1MgU2FmYXJpXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIGhpZGVCb3R0b21CYXIpO1xyXG5mdW5jdGlvbiBoaWRlQm90dG9tQmFyKCkge1xyXG4gICAgd2luZG93LnNjcm9sbFRvKDAsMSk7XHJcbn1cclxuaGlkZUJvdHRvbUJhcigpOyIsImltcG9ydCB7IFN0b3J5TWFuYWdlciB9IGZyb20gXCIuL3N0b3J5L3N0b3J5LW1hbmFnZXJcIjtcclxuaW1wb3J0IHsgVmlzdWFscyB9IGZyb20gXCIuL3Zpc3VhbHNcIjtcclxuaW1wb3J0IHsgVXNlckludGVyZmFjZSB9IGZyb20gXCIuL3VzZXItaW50ZXJmYWNlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSXJpcyB7XHJcbiAgICBzdG9yeU1hbmFnZXI6IFN0b3J5TWFuYWdlcjtcclxuICAgIHVzZXJJbnRlcmZhY2U6IFVzZXJJbnRlcmZhY2U7XHJcbiAgICB2aXN1YWxzOiBWaXN1YWxzO1xyXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcbiAgICB0b3VjaFN0YXJ0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGNvbnN0cnVjdG9yKHBhdGg6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMudXNlckludGVyZmFjZSA9IG5ldyBVc2VySW50ZXJmYWNlKCk7XHJcbiAgICAgICAgdGhpcy52aXN1YWxzID0gbmV3IFZpc3VhbHMoKTtcclxuICAgICAgICB0aGlzLnN0b3J5TWFuYWdlciA9IG5ldyBTdG9yeU1hbmFnZXIocGF0aCk7XHJcblxyXG4gICAgICAgIC8vdGVtcCBjb2RlXHJcbiAgICAgICAgaWYgKCF0aGlzLnN0b3J5TWFuYWdlci5jdXJyZW50Q3VlLnNwZWVjaCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3J5TWFuYWdlci5nb1RvTmV4dFNwZWVjaCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImdhbWVcIik7XHJcbiAgICAgICAgdmFyIGd1aVdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGd1aVdyYXBwZXIuY2xhc3NMaXN0LmFkZChcImludGVyZmFjZS13cmFwcGVyXCIpO1xyXG4gICAgICAgIGd1aVdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy51c2VySW50ZXJmYWNlLnRleHRCb3guZWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGd1aVdyYXBwZXIpO1xyXG5cclxuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UudGV4dEJveC5zaG93VGV4dCh0aGlzLnN0b3J5TWFuYWdlci5jdXJyZW50Q3VlLmNoYXJhY3RlciwgdGhpcy5zdG9yeU1hbmFnZXIuY3VycmVudFNwZWVjaCk7XHJcblxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5hZHZhbmNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudG91Y2hTdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRvdWNoU3RhcnRlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3VjaFN0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWR2YW5jZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuICAgIGFkdmFuY2UoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zdG9yeU1hbmFnZXIuZ29Ub05leHRTcGVlY2goKTtcclxuICAgICAgICB0aGlzLnVzZXJJbnRlcmZhY2UudGV4dEJveC5zaG93VGV4dCh0aGlzLnN0b3J5TWFuYWdlci5jdXJyZW50Q3VlLmNoYXJhY3RlciwgdGhpcy5zdG9yeU1hbmFnZXIuY3VycmVudFNwZWVjaCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBTdG9yeSB9IGZyb20gXCIuL3N0b3J5XCI7XHJcbmltcG9ydCB7IEN1ZSB9IGZyb20gXCIuL2N1ZVwiO1xyXG5pbXBvcnQgeyBDaGFwdGVyIH0gZnJvbSBcIi4vY2hhcHRlclwiO1xyXG5pbXBvcnQgeyBFcGlzb2RlIH0gZnJvbSBcIi4vZXBpc29kZVwiO1xyXG5pbXBvcnQgeyBFdmlkZW5jZSB9IGZyb20gXCIuL2V2aWRlbmNlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU3RvcnlNYW5hZ2VyIHtcclxuICAgIHByaXZhdGUgc3Rvcnk6IFN0b3J5O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RXBpc29kZVBvc2l0aW9uOiBudW1iZXIgPSAwO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50Q2hhcHRlclBvc2l0aW9uOiBudW1iZXIgPSAwO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50Q3VlUG9zaXRpb246IG51bWJlciA9IDA7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRTcGVlY2hQb3NpdGlvbjogbnVtYmVyID0gMDtcclxuICAgIHByaXZhdGUgX2N1cnJlbnRFdmlkZW5jZTogQXJyYXk8RXZpZGVuY2U+ID0gW107XHJcbiAgICBjb25zdHJ1Y3RvcihwYXRoOiBzdHJpbmcpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIHJlcXVlc3Qub3BlbihcIkdFVFwiLCBwYXRoLCBmYWxzZSk7XHJcbiAgICAgICAgcmVxdWVzdC5zZW5kKG51bGwpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICB0aGlzLnN0b3J5ID0gSlNPTi5wYXJzZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgLy90aGlzLnN0b3J5ID0gPFN0b3J5PihKU09OLnBhcnNlKCd7IFwiZXBpc29kZXNcIjpbIHsgXCJ0aXRsZVwiOlwiVGhlIFNjaWVudGlmaWMgVHVybmFib3V0XCIsIFwiY2hhcHRlcnNcIjpbIHsgXCJ0aXRsZVwiOlwiVHJpYWwgTG9iYnlcIiwgXCJjb250ZW50XCI6WyB7IFwiY2hhcmFjdGVyXCI6XCIkUm9va2llXCIsIFwic3BlZWNoXCI6WyBcIiMjbW9kZSh0aG91Z2h0KShNeSBuYW1lIGlzICRSb29raWUsIGFuZCBJbSBhIGRlZmVuY2UgYXR0b3JuZXkuKVwiLCBcIihNb3JlIHNwZWNpZmljYWxseSwgSSBhbSBhIHNjaWVudGlmaWMgYXR0b3JuZXktLWFuZCB0b2RheSBpcyBteSBmaXJzdCBjYXNlLilcIiBdIH0gXSB9IF0gfSwgeyBcInRpdGxlXCI6XCJUdXJuYWJvdXQgZm9yIEZ1dHVyaXR5XCIsIFwibG9ja2VkXCI6dHJ1ZSB9IF0gfScpKTtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnN0b3J5KTtcclxuICAgIH1cclxuICAgIGdldCBjdXJyZW50U3BlZWNoKCk6IHN0cmluZyB7XHJcbiAgICAgICAgdmFyIHNwZWVjaCA9IHRoaXMuc3RvcnkuZXBpc29kZXNbdGhpcy5jdXJyZW50RXBpc29kZVBvc2l0aW9uXS5jaGFwdGVyc1t0aGlzLmN1cnJlbnRDaGFwdGVyUG9zaXRpb25dLmNvbnRlbnRbdGhpcy5jdXJyZW50Q3VlUG9zaXRpb25dLnNwZWVjaFt0aGlzLmN1cnJlbnRTcGVlY2hQb3NpdGlvbl07XHJcbiAgICAgICAgY29uc29sZS5sb2coc3BlZWNoKTtcclxuICAgICAgICByZXR1cm4gc3BlZWNoO1xyXG4gICAgfVxyXG4gICAgZ2V0IGN1cnJlbnRDdWUoKTogQ3VlIHtcclxuICAgICAgICB2YXIgY3VlID0gdGhpcy5zdG9yeS5lcGlzb2Rlc1t0aGlzLmN1cnJlbnRFcGlzb2RlUG9zaXRpb25dLmNoYXB0ZXJzW3RoaXMuY3VycmVudENoYXB0ZXJQb3NpdGlvbl0uY29udGVudFt0aGlzLmN1cnJlbnRDdWVQb3NpdGlvbl07XHJcbiAgICAgICAgaWYgKGN1ZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgXCJFcnJvcjogRm91bmQgY3VlIHRvIGJlIHVuZGVmaW5lZCFcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjdWUpO1xyXG4gICAgICAgIHJldHVybiBjdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgY3VycmVudENoYXB0ZXIoKTogQ2hhcHRlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcnkuZXBpc29kZXNbdGhpcy5jdXJyZW50RXBpc29kZVBvc2l0aW9uXS5jaGFwdGVyc1t0aGlzLmN1cnJlbnRDaGFwdGVyUG9zaXRpb25dXHJcbiAgICB9XHJcbiAgICBnZXQgY3VycmVudEVwaXNvZGUoKTogRXBpc29kZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcnkuZXBpc29kZXNbdGhpcy5jdXJyZW50RXBpc29kZVBvc2l0aW9uXTtcclxuICAgIH1cclxuICAgIGdldCBjdXJyZW50RXZpZGVuY2UoKTogQXJyYXk8RXZpZGVuY2U+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudEV2aWRlbmNlO1xyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEN1ZS5uZXdldmlkZW5jZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50RXZpZGVuY2UucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLmN1cnJlbnRDdWUubmFtZSxcclxuICAgICAgICAgICAgICAgIGlkOiB0aGlzLmN1cnJlbnRDdWUubmV3ZXZpZGVuY2UsXHJcbiAgICAgICAgICAgICAgICBpbWFnZTogdGhpcy5jdXJyZW50Q3VlLmltYWdlID8gdGhpcy5jdXJyZW50Q3VlLmltYWdlIDogXCJodHRwczovL3ByZXZpZXdzLjEyM3JmLmNvbS9pbWFnZXMvaXFvbmNlcHQvaXFvbmNlcHQwOTAxL2lxb25jZXB0MDkwMTAwMDk0LzQyMjE0MTctYS13aGl0ZS13cmlua2xlZC1waWVjZS1vZi1wYXBlci1iYWNrZ3JvdW5kLWZvci1zbGlkZXMtYnJvY2h1cmVzLWFuZC1wcmVzZW50YXRpb25zLS5qcGdcIlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBhZHZhbmNlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRDdWUuc3BlZWNoICYmIHRoaXMuY3VycmVudEN1ZS5zcGVlY2gubGVuZ3RoIC0gMSA+IHRoaXMuY3VycmVudFNwZWVjaFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNwZWVjaFBvc2l0aW9uKys7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWR2YW5jZWQgdG8gbmV4dCBzcGVlY2guIE5ldyBwb3NpdGlvbjogXCIgKyB0aGlzLmN1cnJlbnRTcGVlY2hQb3NpdGlvbik7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRDaGFwdGVyLmNvbnRlbnQubGVuZ3RoID4gdGhpcy5jdXJyZW50Q3VlUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Q3VlUG9zaXRpb24rKztcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3BlZWNoUG9zaXRpb24gPSAwO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkdmFuY2VkIHRvIG5leHQgY3VlLlwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudEVwaXNvZGUuY2hhcHRlcnMubGVuZ3RoID4gdGhpcy5jdXJyZW50Q2hhcHRlclBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudENoYXB0ZXJQb3NpdGlvbisrO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTcGVlY2hQb3NpdGlvbiA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEN1ZVBvc2l0aW9uID0gMDtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJBZHZhbmNlZCB0byBuZXh0IGNoYXB0ZXIuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdvVG9OZXh0U3BlZWNoKCkge1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgdGhpcy5yZWdpc3RlcigpO1xyXG4gICAgICAgICAgICB0aGlzLmFkdmFuY2UoKTtcclxuICAgICAgICB9IHdoaWxlICghdGhpcy5jdXJyZW50Q3VlLnNwZWVjaCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgVmlzdWFscyB7XHJcbiAgICBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmNsYXNzTGlzdC5hZGQoXCJ2aXN1YWxzXCIpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LnJlY3QoMTAsMTAsMjAsMjApO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgVGV4dEJveCB9IGZyb20gXCIuL3RleHQtYm94XCI7XHJcbmltcG9ydCB7IENvdXJ0UmVjb3JkIH0gZnJvbSBcIi4vY291cnQtcmVjb3JkXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgVXNlckludGVyZmFjZSB7XHJcbiAgICB0ZXh0Qm94OiBUZXh0Qm94O1xyXG4gICAgY291cnRSZWNvcmQ6IENvdXJ0UmVjb3JkO1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy50ZXh0Qm94ID0gbmV3IFRleHRCb3goKTtcclxuICAgICAgICB0aGlzLmNvdXJ0UmVjb3JkID0gbmV3IENvdXJ0UmVjb3JkKCk7XHJcbiAgICB9XHJcbn0iLCJpbnRlcmZhY2UgUXVldWVkQ2hhcmFjdGVyIHtcclxuICAgIGNoYXJhY3Rlcjogc3RyaW5nO1xyXG4gICAgbW9kZTogc3RyaW5nO1xyXG4gICAgc3BlZWQ6IHN0cmluZztcclxuICAgIGluZGV4OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUZXh0Qm94IHtcclxuICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gICAgc3BlYWtlckVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gICAgdGV4dEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gICAgYmxpcE51bTogbnVtYmVyO1xyXG4gICAgaXNGaW5pc2hlZDogYm9vbGVhbjtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0ZXh0XCIsXCJ0ZXh0LWJveFwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5zcGVha2VyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgIHRoaXMuc3BlYWtlckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm5hbWVcIik7XHJcblxyXG4gICAgICAgIHRoaXMudGV4dEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRoaXMudGV4dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRleHQtYmxvY2tcIik7XHJcblxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnNwZWFrZXJFbGVtZW50KTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy50ZXh0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICBjbGVhcigpIHtcclxuICAgICAgICB3aGlsZSAodGhpcy50ZXh0RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCkgeyB0aGlzLnRleHRFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkLnJlbW92ZSgpOyB9XHJcbiAgICAgICAgdGhpcy5zcGVha2VyRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5ibGlwTnVtID0gMDtcclxuICAgICAgICB0aGlzLmlzRmluaXNoZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHNob3dUZXh0KHNwZWFrZXI6IHN0cmluZywgdGV4dDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5jbGVhcigpO1xyXG5cclxuICAgICAgICB0aGlzLnNwZWFrZXJFbGVtZW50LnRleHRDb250ZW50ID0gc3BlYWtlcjtcclxuXHJcbiAgICAgICAgLy92YXIgcXVldWVkQ2hhcmFjdGVyczogQXJyYXk8UXVldWVkQ2hhcmFjdGVyPiA9IFtdO1xyXG5cclxuICAgICAgICB2YXIgc3BlZWQ6IFwiZmFzdFwiIHwgXCJzbG93XCIgfCBcInZlcnktc2xvd1wiID0gXCJmYXN0XCI7XHJcbiAgICAgICAgdmFyIG1vZGU6IFwic3BlZWNoXCIgfCBcInRob3VnaHRcIiB8IFwiZW1waGFzaXNcIiB8IFwib2JqZWN0XCIgfCBcInF1ZXN0aW9uXCIgPSBcInNwZWVjaFwiO1xyXG5cclxuICAgICAgICB2YXIgcGFyc2VDaGFyID0gZnVuY3Rpb24gKGluZGV4OiBudW1iZXIpOiBvYmplY3Qge1xyXG4gICAgICAgICAgICB2YXIgY2hhciA9IHRleHRbaW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoIShjaGFyID09IFwiI1wiICYmIHRleHRbaW5kZXggKyAxXSA9PSBcIiNcIikpIHtcclxuICAgICAgICAgICAgICAgIC8vcmV0dXJuIG5ldyBRdWV1ZWRDaGFyYWN0ZXIodGV4dFtpbmRleF0sIG1vZGUsIHNwZWVkLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcWNoYXI6IFF1ZXVlZENoYXJhY3RlciA9IHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IHRleHRbaW5kZXhdLFxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGU6IG1vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgc3BlZWQ6IHNwZWVkLFxyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHFjaGFyO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAvL0RldGVybWluaW5nIHRoZSBjb21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW1hbmQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBpbmRleCArIDI7IHRleHRbaV0gIT0gXCIoXCIgJiYgdGV4dC5sZW5ndGggPiBpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZCArPSB0ZXh0W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9EZXRlcm1pbmluZyBpdHMgcGFyYW1ldGVyc1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbVN0cmluZyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbXM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gaSArIDE7IHRleHRbal0gIT0gXCIpXCIgJiYgdGV4dC5sZW5ndGggPiBqOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1TdHJpbmcgKz0gdGV4dFtqXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1TdHJpbmcuc3BsaXQoXCIsXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm1vZGVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGUgPSBwYXJhbXNbMF0gYXMgXCJzcGVlY2hcIiB8IFwidGhvdWdodFwiIHwgXCJlbXBoYXNpc1wiIHwgXCJvYmplY3RcIiB8IFwicXVlc3Rpb25cIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWVkID0gcGFyYW1zWzBdIGFzIFwiZmFzdFwiIHwgXCJzbG93XCIgfCBcInZlcnktc2xvd1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIGogKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGluZGV4OiBqIH07XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVbmFibGUgdG8gcGFyc2UgY29tbWFuZCFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vcmV0dXJuIGluZGV4ICsgMTtcclxuICAgICAgICB9LmJpbmQodGhpcyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG5leHRDaGFyKGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImluZGV4OiBcIiArIGluZGV4ICsgXCIgIHRleHQgbGVuZ3RoOiBcIiArIHRleHQubGVuZ3RoKTtcclxuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgdGV4dC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hhciA9IHBhcnNlQ2hhcihpbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRJbmRleCA9IGNoYXIuaW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChUZXh0Qm94Lmluc3RhbmNlT2ZRdWV1ZWRDaGFyYWN0ZXIoY2hhcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDaGFyKGNoYXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXh0Q2hhci5iaW5kKHRoaXMpKG5leHRJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgVGV4dEJveC5nZXRXYWl0VGltZShzcGVlZCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGFyID0gcGFyc2VDaGFyKGkpO1xyXG4gICAgICAgICAgICBpZiAoIVRleHRCb3guaW5zdGFuY2VPZlF1ZXVlZENoYXJhY3RlcihjaGFyKSkge1xyXG4gICAgICAgICAgICAgICAgaSA9IGNoYXIuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgY2hhckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuICAgICAgICAgICAgY2hhckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRleHRcIiwgbW9kZSwgXCJoaWRkZW5cIik7XHJcbiAgICAgICAgICAgIGNoYXJFbGVtZW50LnRleHRDb250ZW50ID0gdGV4dFtpXTtcclxuICAgICAgICAgICAgY2hhckVsZW1lbnQuZGF0YXNldC5pbmRleCA9IFwiXCIgKyBpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50ZXh0RWxlbWVudC5hcHBlbmRDaGlsZChjaGFyRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBuZXh0Q2hhci5iaW5kKHRoaXMpKDApO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBnZXRXYWl0VGltZShzcGVlZDogXCJmYXN0XCIgfCBcInNsb3dcIiB8IFwidmVyeS1zbG93XCIpOiBudW1iZXIge1xyXG4gICAgICAgIHN3aXRjaChzcGVlZCkge1xyXG4gICAgICAgICAgICBjYXNlIFwiZmFzdFwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDIwO1xyXG4gICAgICAgICAgICBjYXNlIFwic2xvd1wiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDUwO1xyXG4gICAgICAgICAgICBjYXNlIFwidmVyeS1zbG93XCI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMjAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgaW5zdGFuY2VPZlF1ZXVlZENoYXJhY3RlcihjaGFyOiBhbnkpOiBjaGFyIGlzIFF1ZXVlZENoYXJhY3RlciB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjaGFyKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGNoYXIuY2hhcmFjdGVyICE9PSB1bmRlZmluZWQpO1xyXG4gICAgICAgIHJldHVybiBjaGFyLmNoYXJhY3RlciAhPT0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENoYXIoY2hhcjogUXVldWVkQ2hhcmFjdGVyKTogdm9pZCB7XHJcbiAgICAgICAgdmFyIGNoYXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWluZGV4PSdcIiArIGNoYXIuaW5kZXggKyBcIiddXCIpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCJyYW5cIik7XHJcbiAgICAgICAgY2hhckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcclxuICAgICAgICAvKnZhciBjaGFyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgIGNoYXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0ZXh0XCIsIG1vZGUpO1xyXG4gICAgICAgIGNoYXJFbGVtZW50LnRleHRDb250ZW50ID0gY2hhcmFjdGVyO1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiQWRkZWQ6IFwiICsgY2hhcmFjdGVyKTtcclxuXHJcbiAgICAgICAgdGhpcy50ZXh0RWxlbWVudC5hcHBlbmRDaGlsZChjaGFyRWxlbWVudCk7Ki9cclxuXHJcbiAgICAgICAgdmFyIGlzUHJvbm91bmNlZCA9IFwiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIjtcclxuXHJcbiAgICAgICAgLy9pZiAoKGNoYXIuc3BlZWQgIT0gXCJmYXN0XCIgfHwgdGhpcy5ibGlwTnVtICUgMiA9PSAwKSAmJiBpc1Byb25vdW5jZWQuaW5jbHVkZXMoY2hhci5jaGFyYWN0ZXIudG9Mb3dlckNhc2UoKSkpIHtcclxuICAgICAgICAgICAgLy9uZXcgQXVkaW8oXCJyZXNvdXJjZXMvRGVlcE1hbGVCbGlwLndhdlwiKS5wbGF5KCk7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJQbGF5ZWQgc291bmQsIGJsaXAlOiBcIiArIHRoaXMuYmxpcE51bSAlIDIpO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIHRoaXMuYmxpcE51bSsrO1xyXG4gICAgICAgIGlmIChjaGFyLmNoYXJhY3RlciA9PSBcIiBcIikge1xyXG4gICAgICAgICAgICB0aGlzLmJsaXBOdW0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBDb3VydFJlY29yZCB7XHJcbiAgICBfc3RhdGU6IFwib3BlbmVkXCIgfCBcImNsb3NlZFwiO1xyXG4gICAgZWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiY291cnQtcmVjb3JkXCIsXCJ0ZXh0XCIpO1xyXG4gICAgfVxyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==